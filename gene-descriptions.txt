For maintainer description, see below. 
User description (should this go elsewhere?):

Gene descriptions are intended to give rough idea of what the function of a
gene might be; they are generated automatically as follows. EnsEMBL has a
mapping from predicted peptides to a number of databases, SWISS-PROT and
SP-TrEMBL among them. (For information on how this mapping is established,
see protein.txt)

For each EnsEMBL gene, the mapping to SWISS-PROT or SP-TrEMBL of the
corresponding EnsEMBL peptides is followed, and the SWISS-PROT/SP-TrEMBL
description line is taken as 'the gene description'. 

Since one gene can have many peptides, and since one peptide can map to
several different SWISS-PROT or SP-TrEMBL proteins, some precedence rules are
in place. They are:

 - SWISS-PROT takes precedence over SP-TrEMBL. If there are more than one
   different SWISS-PROT proteins for an EnsEMBL gene, the first one
   taken. This may sound arbitrary, but in practice, these descriptions are
   very similar

 - If there are several SP-TrEMBL mappings, precedence is established on the
   basis of the occurrence of regular expression patterns in the description
   line. In order of increasing precerence, these patterns currently are:

      unknown hypothetical putative novel probable [0-9]{3} kDa fragment cdna
      protein. 
   
   If after this, two SP-TrEMBL description lines still have equal
   precedence, the longest description is taken. This precedence list is a
   bit arbitrary, and is bound to be 'tweaked' to get 'better' descriptions
   (see ensembl/scripts/gene-descriptions.pl for the most recent list)

   We don't (yet) rank the descriptions using the similarity measure used in
   establishing the mapping.

At this stage, there are still many (perhaps half) of the genes without a
description. For these, the consensus description of the family or 'Tribe' to
which they belong are used to are transferred (see family.txt for a
description of the Family database).

Occasionally, peptides from one gene fall into different families. In these
cases, the same ranking as described above for multiple SP-TrEMBL mappings is
used to choose a description.

------------------------------------------------------------------------

Maintainer description:

This is incomplete, since it needs the family database as well, which hasn't
been properly documented yet. But the first bits are:

 - make sure the peptide mapping has been done

 - get hold of the swissprot/trembl file used for the peptide mapping (it can
   be big and can contain the swissprot internal bits, like {}

 - assuming ensembl/scripts is in your $PATH, do:

     sp-descriptions.pl < swiss-prot-flatfile  > sp-descriptions.dat

   This produces a summary of sp/trembl -> descriptions mappings

 - next, on the database that contains the peptide mapping, do:
 
     sp-mapping-dump.sh -h host -u user database

   This produces a file mapping.dat (and .log), containing the ENSG ->
   sp/trembl accnos mapping

 - Produce the tab-delimited data file to be loaded into the gene-description
   table:

     gene-descriptions.pl sp-descriptions.dat mapping.dat > gene-descriptions.dat

 - Load it into a into an ensembl database, e.g. as

     echo "load data infile '`pwd`/gene-descriptions' \
             into table gene_description;" | mysql -u user -host databasename

 - (preceeding steps should be integrated with the peptide mapping pipeline)

 - The next step is adding the family additions for genes that have no or a
   poor description. This boils down to running

     ensembl/scripts/desc-from-fam.sh coreDB -h host -u user famDB

   which will, in famDB, create a merged gene_description table that is a
   replacement for the old one in coreDB (it does not automatically replace
   the old one; this has to be done by hand). The script writes a few
   statistics to stdout. Look in the script itself for further directions.
